<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Rock Paper Scissors</title>
  </head>
  <body>
    <div id="rounds">Rounds Played: 0</div>
    <div id="score">Player 0 : 0 Computer</div>

    <div id="buttons">
      <button id="rock">Rock</button>
      <button id="paper">Paper</button>
      <button id="scissors">Scissors</button>
    </div>

    <div id="results"></div>

    <script>
      function computerPlay() {
        // Let the computer make it's choice
        return validOptionArray[
          Math.floor(Math.random() * validOptionArray.length)
        ].toLocaleLowerCase();
      }

      function isValid(playerSelection) {
        return validOptionArray.includes(playerSelection);
      }

      function playRound(playerSelection, computerSelection) {
        // Convert user input to lowercase for deciding the winner in the function underneath
        playerSelection = playerSelection.toLowerCase();

        // Check if value is valid
        if (!isValid(playerSelection)) {
          return "Please enter Rock, Paper, or Scissors and try again";
        }

        let result = decideWinner(playerSelection, computerSelection);

        // Capitalize playerSelection and computerSelection so it looks neat upon notifying the player
        playerSelection = capitalize(playerSelection);
        computerSelection = capitalize(computerSelection);

        return notifyPlayer(result, playerSelection, computerSelection);
      }

      function notifyPlayer(result, playerSelection, computerSelection) {
        // Notify player about the outcome of the round
        if (result == "win") {
          return `You Win! ${playerSelection} beats ${computerSelection}!`;
        } else if (result == "lose") {
          return `You lose! ${computerSelection} beats ${playerSelection}!`;
        } else if (result == "tie") {
          return "It's a tie!";
        } else {
          return "Something went wrong!";
        }
      }

      function decideWinner(playerSelection, computerSelection) {
        let win, lose, tie;
        // Decide the winner using if statements
        if (playerSelection === "rock") {
          if (computerSelection === "paper") {
            lose = true;
          } else if (computerSelection === "rock") {
            tie = true;
          } else if (computerSelection === "scissors") {
            win = true;
          }
        } else if (playerSelection === "paper") {
          if (computerSelection === "scissors") {
            lose = true;
          } else if (computerSelection === "paper") {
            tie = true;
          } else if (computerSelection === "rock") {
            win = true;
          }
        } else if (playerSelection === "scissors") {
          if (computerSelection === "rock") {
            lose = true;
          } else if (computerSelection === "scissors") {
            tie = true;
          } else if (computerSelection === "paper") {
            win = true;
          }
        }

        if (win) {
          playerWinCount++;
          return "win";
        } else if (tie) {
          return "tie";
        } else {
          computerWinCount++;
          return "lose";
        }
      }

      function game(n) {
        //   Play n rounds of RPS
        for (let index = 0; index < n; index++) {
          console.log(
            playRound(
              (playerSelection = prompt(
                "Please enter Rock, Paper, or Scissors!"
              )),
              computerPlay()
            )
          );
        }
      }

      function capitalize(word) {
        return word[0].toUpperCase() + word.slice(1);
      }

      const validOptionArray = ["rock", "paper", "scissors"];
      let roundsPlayed = 0;
      let playerWinCount = 0;
      let computerWinCount = 0;
      const resultDiv = document.querySelector("#results");
      const buttons = document.querySelectorAll("button");
      const roundCounterDiv = document.querySelector('#rounds');
      const scoreDiv = document.querySelector("#score");

      buttons.forEach((button) => {
        button.addEventListener("click", (e) => {
          const roundResult = document.createElement("p");
          roundResult.textContent = playRound(e.target.id, computerPlay());
          roundsPlayed++;

          roundCounterDiv.textContent = `Rounds Played: ${roundsPlayed}`
          scoreDiv.textContent = `Player ${playerWinCount} : ${computerWinCount} Computer`;
          resultDiv.appendChild(roundResult);
        });
      });
    </script>
  </body>
</html>
